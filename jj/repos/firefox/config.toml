#:schema https://jj-vcs.github.io/jj/latest/config-schema.json

# NOTE: This configuration was generated from Erich's scripting at
# <https://github.com/erichdongubler-mozilla/fx-scripts>. If you need to edit it,
# consider sharing upstream!

fsmonitor.backend = "watchman"
# fsmonitor.watchman.register-snapshot-trigger = true

[aliases]
"trains" = ["log", "--revisions=show_fork_point(trains() | @)"]

[revset-aliases]
"trunk()" = "main@upstream"

# NOTE: Typical `builtin_immutable_heads()` is `trunk() | tags() | untracked_remote_branches()`, but
# I want to exclude tags of the form `pin/*`. It's weird, I know, but it's what I want!
"immutable_heads()" = '''
trunk() | tags(regex:"^[^p][^i][^n][^/]") | untracked_remote_bookmarks()
| remote_bookmarks(exact:'autoland')
| trains()
'''

"trains()" = '''
trunk()
| remote_bookmarks(exact:'beta')
| remote_bookmarks(regex:'^esr\d+$')
| remote_bookmarks(exact:'release')
'''

[git]
fetch = ["origin", "upstream"]

[remotes.origin]
auto-track-bookmarks = "*"
